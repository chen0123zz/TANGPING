<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èººå¹³é‹å‹•æŒ‰æ‘© TANG PING - é ç´„å®˜ç¶²</title>
    <link rel="icon" href="images/LOGO2.png" type="image/png">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ğŸ¨ å…¨åŸŸè¨­å®š */
        :root { --brand-color: #efb748; --bg-beige: #f9f5f0; --text-dark: #333333; --admin-bg: #f0f2f5; --admin-card: #ffffff; --admin-text: #333333; }
        html { scroll-behavior: smooth; -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }
        body { font-family: 'Noto Sans TC', sans-serif; margin: 0; padding: 0; background-color: var(--bg-beige); color: var(--text-dark); }
        section, .content-section { scroll-margin-top: 100px; }

        /* ğŸ  å‰å°æ¨£å¼ (V25 Base) */
        header { background-color: #fff; padding: 15px 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .header-content { display: flex; justify-content: space-between; align-items: center; max-width: 1000px; margin: 0 auto; }
        .logo-img { height: 50px; }
        .nav-menu a { text-decoration: none; color: #333; margin-left: 20px; font-weight: bold; font-size: 0.95rem; transition: color 0.3s; }
        .nav-menu a:hover { color: var(--brand-color); }

        .content-section { padding: 40px 20px; max-width: 800px; margin: 0 auto; text-align: center; }
        .section-title { color: var(--brand-color); font-size: 2rem; margin-bottom: 10px; }
        .btn-main { display: inline-block; background-color: #fff; color: var(--brand-color); padding: 12px 30px; border-radius: 30px; text-decoration: none; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        .offerSwiper { width: 100%; padding: 20px 0 50px 0; }
        .offer-card-layout { background: #fff; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; max-width: 900px; margin: 0 auto; }
        .offer-img-box { flex: 1; min-height: 300px; display: flex; align-items: center; justify-content: center; background-color: #fff; padding: 30px; }
        .offer-img-box img { width: 100%; height: 100%; object-fit: contain; }
        .offer-text-box { flex: 1; padding: 40px; text-align: left; display: flex; flex-direction: column; justify-content: center; }
        .tag-pill { display: inline-block; background-color: #ff4757; color: #fff; padding: 5px 15px; border-radius: 50px; font-size: 0.9rem; font-weight: bold; margin-bottom: 10px; }
        .price-highlight { display: flex; gap: 15px; background: #f9f9f9; padding: 15px; border-radius: 10px; margin-bottom: 20px; color: var(--brand-color); }
        .offer-list { list-style: none; padding: 0; margin-bottom: 20px; color: #555; text-align: left; }

        .swiper { width: 100%; max-width: 1200px; margin: 0 auto; padding-bottom: 40px; padding-top: 20px; }
        .swiper-slide { background-position: center; background-size: cover; width: auto; height: auto; }
        .slide-img { display: block; width: 100%; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .my-prev-btn, .my-next-btn { position: absolute; top: 60%; transform: translateY(-50%); width: 40px; height: 40px; background-color: #fff; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; z-index: 10; cursor: pointer; }
        .my-prev-btn { left: 10px; } .my-next-btn { right: 10px; }
        
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; text-align: left; }
        .service-card { background: #fff; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .card-body { padding: 25px; }
        .desc { color: #666; line-height: 1.6; margin-bottom: 20px; font-size: 0.95rem; }
        
        table { width: 100%; border-collapse: collapse; background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        th, td { padding: 15px; border: 1px solid #ddd; }

        /* Calendar */
        .booking-container { background: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); max-width: 700px; margin: 0 auto; text-align: left; }
        .month-selector { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .month-btn { background: none; border: 1px solid #ddd; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 1.2rem; }
        .month-title-group { display: flex; flex-direction: column; align-items: center; }
        .today-btn { font-size: 0.75rem; padding: 2px 10px; margin-top: 5px; background: #eee; color: #666; border: none; border-radius: 15px; cursor: pointer; transition: 0.2s; }
        .today-btn:hover { background: var(--brand-color); color: #fff; }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-bottom: 30px; }
        .cal-header { font-size: 0.8rem; font-weight: bold; color: #888; padding-bottom: 5px; text-align: center; }
        .calendar-day { border: 1px solid #ddd; border-radius: 12px; height: 75px; text-align: center; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: 0.2s; }
        .calendar-day.active { background-color: var(--brand-color); color: #fff; border-color: var(--brand-color); }
        .calendar-day.disabled { background-color: #f9f9f9; color: #ccc; cursor: not-allowed; pointer-events: none; }
        
        .calendar-day.today { border: 2px solid var(--brand-color); font-weight: bold; background: transparent; color: var(--text-dark); }
        .calendar-day.today.active { background-color: var(--brand-color) !important; color: #fff !important; }

        .calendar-day.holiday { background-color: #fff0f0 !important; border: 2px solid #ffcccc !important; color: #d63031 !important; pointer-events: auto !important; }
        .calendar-day.holiday span { color: #d63031 !important; display: block; }
        
        .calendar-day.full { background-color: #e0e0e0 !important; color: #888 !important; pointer-events: none; }
        .calendar-day.full span { color: #888 !important; }

        .time-selector h3 { display: flex; align-items: center; gap: 10px; }
        #selected-date-display { font-size: 1rem; color: var(--brand-color); font-weight: bold; background: #fffaf0; padding: 2px 10px; border-radius: 15px; }

        .time-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .time-btn { padding: 10px; background: #fff; border: 1px solid var(--brand-color); border-radius: 5px; color: var(--brand-color); cursor: pointer; transition: 0.2s; }
        .time-btn:hover, .time-btn.selected { background-color: var(--brand-color); color: #fff; }
        .time-btn.disabled { background-color: #f0f0f0; border-color: #ddd; color: #ccc; cursor: not-allowed; pointer-events: none; }

        /* Info & QA */
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; max-width: 1000px; margin: 0 auto; }
        .info-card { background: #fff; padding: 20px 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); text-align: left; transition: transform 0.2s; border-left: 5px solid transparent; }
        .info-card:hover { transform: translateY(-3px); border-left: 5px solid var(--brand-color); box-shadow: 0 8px 15px rgba(0,0,0,0.08); }
        .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .info-icon { font-size: 1.8rem; line-height: 1; }
        .info-card h4 { margin: 0; font-size: 1.2rem; color: #333; }
        .info-card p { margin: 0; color: #666; font-size: 0.95rem; line-height: 1.6; }
        .qa-grid { display: grid; gap: 30px; margin-top: 40px; grid-template-columns: 1fr 1fr; }
        .qa-card { background: #fff; padding: 30px; border-radius: 20px; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; text-align: left; }
        .qa-badge { position: absolute; top: -15px; left: 20px; background-color: #5e4b35; color: #fff; padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .qa-card h3 { margin-top: 10px; color: #333; font-size: 1.3rem; }

        /* Contact */
        .contact-container { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .map-box { height: 300px; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .contact-item { font-size: 1.1rem; margin: 15px 0; line-height: 1.6; }
        .time-list-desktop { white-space: nowrap !important; display: block !important; }
        .social-row { display: block; }
        .social-row .contact-item { margin-bottom: 10px; margin-top: 0; display: inline-block; margin-right: 20px; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        .contact-info .btn-main { width: auto; }
        .mobile-break { display: none; }

        /* Floating Btn */
        .floating-btn-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 999; transition: opacity 0.5s ease; }
        .float-btn { width: 45px; height: 45px; background-color: var(--brand-color); color: #fff; border: none; border-radius: 50%; font-size: 1.2rem; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; }
        footer { text-align: center; padding: 5px 5px; background-color: transparent; color: #999; font-size: 0.85rem; margin-top: 20px; }

        /* Modals & Admin */
        #booking-modal-overlay, #admin-login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(3px); z-index: 10002; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .booking-modal, .admin-login-box { background: #fff; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; text-align: left; }
        .booking-modal h3, .admin-login-box h2 { margin-top: 0; color: var(--brand-color); text-align: center; }
        #booking-info-text { font-size: 1.1rem !important; color: var(--brand-color) !important; font-weight: bold; margin-bottom: 20px !important; text-align: center; }
        
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; font-size: 0.9rem; color: #666; margin-bottom: 5px; }
        .required { color: red; margin-left: 3px; }
        .form-input, .form-select, .login-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; font-size: 1rem; margin-bottom: 10px; }
        .modal-close { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999; }
        .login-btn { background: var(--brand-color); color: #fff; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
        #toast-msg { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: #fff; padding: 10px 20px; border-radius: 20px; font-size: 0.9rem; z-index: 20000; opacity: 0; transition: opacity 0.3s; pointer-events: none; }

        /* Admin UI */
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--admin-bg); z-index: 10000; overflow-y: auto; color: var(--admin-text); }
        .admin-header { background-color: #fff; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .admin-header h1 { margin: 0; font-size: 1.2rem; color: var(--brand-color); }
        .admin-container { max-width: 600px; margin: 20px auto; padding: 0 15px; padding-bottom: 60px; }
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .dash-card { background: #fff; padding: 15px; border-radius: 10px; text-align: center; border-left: 4px solid var(--brand-color); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .dash-num { font-size: 1.8rem; font-weight: bold; color: #333; margin: 5px 0; }
        .admin-card { background: #fff; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .admin-toolbar { display: flex; justify-content: center; gap: 10px; margin-bottom: 15px; }
        .admin-tool-btn { background-color: #fff; border: 1px solid #ddd; color: #666; padding: 8px 15px; border-radius: 20px; font-size: 0.9rem; cursor: pointer; display: flex; align-items: center; gap: 5px; }
        .admin-tool-btn:hover { background-color: var(--brand-color); color: #fff; border-color: var(--brand-color); }
        .admin-cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; }
        .admin-cal-head { font-size: 0.7rem; color: #888; margin-bottom: 5px; }
        .admin-cal-cell { aspect-ratio: 1/1; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 8px; border: 1px solid #eee; font-size: 0.9rem; cursor: pointer; position: relative; background: #fff; transition: all 0.2s; color: #333; }
        .admin-cal-cell.today { border: 2px solid var(--brand-color); font-weight: bold; }
        .admin-cal-cell.selected { background-color: var(--brand-color); color: #fff; border-color: var(--brand-color); }
        .admin-cal-cell.holiday { background-color: #fff0f0; color: #d63031; text-decoration: none; }
        .dot { width: 6px; height: 6px; border-radius: 50%; margin-top: 2px; background-color: #2ecc71; display: none; }
        .dot.active { display: block; }
        .event-text { display: none; } 
        .admin-cal-grid.detail-mode .admin-cal-cell { aspect-ratio: auto; min-height: 80px; justify-content: flex-start; padding-top: 5px; align-items: stretch; }
        .admin-cal-grid.detail-mode .dot { display: none; } 
        .admin-cal-grid.detail-mode .event-text { display: block; font-size: 0.65rem; color: #fff; background-color: #2ecc71; margin: 2px 0; padding: 2px 4px; border-radius: 3px; text-align: left; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
        .admin-cal-grid.detail-mode .admin-cal-cell.holiday .event-text { display: none; }

        /* ğŸ”¥ V63.0: è¨‚å–®å¡ç‰‡å„ªåŒ–æ¨£å¼ */
        .order-item { background: #fff; border: 1px solid #eee; border-left: 5px solid var(--brand-color); padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.95rem; }
        .info-label { color: #888; min-width: 70px; }
        .info-value { color: #333; font-weight: 500; text-align: right; flex: 1; }
        .order-header { border-bottom: 1px dashed #eee; padding-bottom: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .order-time-badge { background: var(--brand-color); color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 0.85rem; font-weight: bold; }
        .status-badge { font-size: 0.8rem; padding: 2px 8px; border-radius: 10px; background: #eee; color: #666; }
        .status-badge.paid { background: #d4edda; color: #155724; }

        .action-btns { display: flex; gap: 10px; margin-top: 15px; }
        .status-btn { flex: 1; padding: 8px 10px; border: none; border-radius: 5px; font-size: 0.9rem; cursor: pointer; color: #fff; font-weight: bold; transition: 0.2s; }
        .btn-done { background: #27ae60; }
        .btn-done.undo { background: #f39c12; } /* å›å¾©æœªä»˜æ¬¾æ¨£å¼ */
        .btn-cancel { background: #e74c3c; }

        .admin-big-btn-group { display: flex; gap: 10px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; }
        .admin-big-btn { flex: 1; padding: 15px; border: none; border-radius: 10px; font-size: 1rem; font-weight: bold; cursor: pointer; color: #fff; display: flex; align-items: center; justify-content: center; gap: 5px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-holiday-big { background-color: #e74c3c; }
        .btn-open-big { background-color: #2ecc71; }
        .admin-time-management { margin-top: 20px; background: #fafafa; padding: 15px; border-radius: 10px; }
        .admin-time-title { font-size: 0.95rem; font-weight: bold; margin-bottom: 10px; color: #555; }
        .admin-time-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .time-switch { display: flex; align-items: center; justify-content: space-between; background: #fff; padding: 8px 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 0.85rem; }
        .switch-input { margin-left: 5px; transform: scale(1.2); cursor: pointer; }
        .control-btn { background: none; border: 1px solid #ddd; color: #666; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; cursor: pointer; }

        @media (max-width: 768px) {
            .offer-card-layout { flex-direction: column; }
            .contact-container { display: flex; flex-direction: column; gap: 30px; }
            .btn-group { flex-direction: column; }
            .contact-info .btn-main { width: 100%; margin: 0; }
            .calendar-day { width: 100%; height: auto; aspect-ratio: 1/1; font-size: 0.75rem; }
            .social-row { flex-direction: column; gap: 5px; }
            .social-row .contact-item { margin-bottom: 0; }
            .time-list-desktop { white-space: normal !important; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <img src="images/logo.png" alt="èººå¹³é‹å‹•æŒ‰æ‘© LOGO" class="logo-img">
            <nav class="nav-menu">
                <a href="#news">æœ€æ–°å„ªæƒ </a>
                <a href="#about">é—œæ–¼èººå¹³</a>
                <a href="#services">åƒ¹ç›®è¡¨</a>
                <a href="#notice">é ç´„é ˆçŸ¥</a>
                <a href="#contact">è¯çµ¡æˆ‘å€‘</a>
            </nav>
        </div>
    </header>

    <section class="content-section" id="news" style="background-color: #f9f5f0; padding-bottom: 40px;">
        <h2 class="section-title">ğŸ‰ æœ€æ–°æ´»å‹• & ç¨å®¶å„ªæƒ </h2>
        <p class="section-desc">ç‚ºæ‚¨æº–å‚™çš„å°ˆå±¬æ”¾é¬†ææ¡ˆ ğŸ‘‡</p>
        <div class="swiper offerSwiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><div class="offer-card-layout"><div class="offer-img-box"><img src="images/ç•¶æœˆå£½æ˜Ÿå„ªæƒ .png" alt="ç”Ÿæ—¥å„ªæƒ "></div><div class="offer-text-box"><span class="tag-pill">å£½æ˜Ÿç¨äº« ğŸ‚</span><h3>ç•¶æœˆå£½æ˜ŸæŠ˜æŠµ $200</h3><p>ç”Ÿæ—¥æ˜¯å°ˆå±¬æ–¼è‡ªå·±çš„æ—¥å­ï¼Œå€¼å¾—è¢«å¥½å¥½æ…¶ç¥ï¼<br>æ­¡è¿ä¾†èººå¹³é‹å‹•æŒ‰æ‘©ï¼Œå¸ä¸‹ç–²æ†Šï¼Œçµ¦èº«å¿ƒä¸€ä»½æ”¾é¬†çš„ç¦®ç‰©ã€‚</p><a href="#booking" class="btn-main" style="margin-top: 15px;">ğŸ”» ç«‹å³é ç´„ç”Ÿæ—¥ç¦®</a></div></div></div>
                <div class="swiper-slide"><div class="offer-card-layout"><div class="offer-img-box"><img src="images/å­¸ç”Ÿå„ªæƒ .png" alt="å­¸ç”Ÿå„ªæƒ "></div><div class="offer-text-box"><span class="tag-pill" style="background:#e67e22;">å­¸ç”Ÿé™å®š ğŸ“</span><h3>æ†‘å­¸ç”Ÿè­‰æŠ˜æŠµ $200</h3><p>ä¸è«–ä½ æ˜¯åœ¨æ“å ´æ®æ±—ï¼Œé‚„æ˜¯åœ¨è€ƒå ´ä¸­æ‹¼æã€‚<br>å¿«ä¾†æ”¾é¬†è‚Œè‚‰èˆ‡å£“åŠ›ï¼Œé‡æ•´èº«å¿ƒï¼Œè£œå¥½èƒ½é‡å†å‡ºç™¼ï¼</p><a href="#booking" class="btn-main" style="margin-top: 15px;">ğŸ”» å­¸ç”Ÿå°ˆå±¬é ç´„</a></div></div></div>
                <div class="swiper-slide"><div class="offer-card-layout"><div class="offer-img-box"><img src="images/åŒ…å ‚å„ªæƒ æ–¹æ¡ˆ.png" alt="åŒ…å ‚å„ªæƒ "></div><div class="offer-text-box"><span class="tag-pill" style="background:#d35400;">æœ€åˆ’ç®— ğŸ”¥</span><h3>åŒ…å ‚å„ªæƒ æ–¹æ¡ˆ</h3><p>æƒ³è¦å®šæœŸä¿é¤Šèº«é«”å—ï¼ŸåŒ…å ‚æ–¹æ¡ˆè®“æ‚¨çœæ›´å¤šï¼</p><div class="price-highlight"><div><strong>åŒ…äº”å ‚</strong> <br> çœ $500</div><div style="border-left: 1px solid #ddd; padding-left: 15px;"><strong>åŒ…åå ‚</strong> <br> çœ $2000</div></div><a href="https://line.me/R/ti/p/@tangping" target="_blank" class="btn-main" style="margin-top: 15px;">ğŸ’¬ ç§è¨Šè©¢å•åŒ…å ‚</a></div></div></div>
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-next" style="color: var(--brand-color);"></div>
            <div class="swiper-button-prev" style="color: var(--brand-color);"></div>
        </div>
    </section>

    <section class="content-section" id="booking">
        <h2 class="section-title">ç·šä¸Šé ç´„</h2>
        <div class="booking-container">
            <div class="date-selector">
                <div class="month-selector"><button class="month-btn" onclick="prevMonth()">â®</button><div class="month-title-group"><h3 id="currentMonthYear"></h3><button class="today-btn" onclick="resetToToday()">å›åˆ°ä»Šå¤©</button></div><button class="month-btn" onclick="nextMonth()">â¯</button></div>
                <div class="calendar-grid" id="calendar-grid-front"></div>
            </div>
            <div class="time-selector"><h3>2. é¸æ“‡æ™‚æ®µ <span id="selected-date-display"></span></h3><div class="time-grid" id="time-grid"></div></div>
        </div>
    </section>
    
    <footer><p>Â© 2025 TANG PING Sport Massage.</p><p style="margin-top:10px;"><span onclick="openAdmin()" style="opacity:0.2; cursor:pointer; font-size:1.2rem;">ğŸ”’</span></p></footer>
    <div class="floating-btn-container"><button onclick="scrollToTop()" class="float-btn">â–²</button><button onclick="scrollToBottom()" class="float-btn">â–¼</button></div>

    <div id="booking-modal-overlay">
        <div class="booking-modal">
            <button class="modal-close" onclick="closeBookingForm()">Ã—</button>
            <h3>é ç´„ç¢ºèª</h3>
            <p id="booking-info-text"></p>
            <div class="form-group"><label class="form-label">å§“å <span class="required">*</span></label><input type="text" id="booking-name" class="form-input" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å"></div>
            <div class="form-group"><label class="form-label">è¯çµ¡é›»è©± <span class="required">*</span></label><input type="tel" id="booking-phone" class="form-input" placeholder="09xx-xxx-xxx" maxlength="15" oninput="this.value = formatPhone(this.value)"></div>
            <div class="form-group"><label class="form-label">LINE ID (é¸å¡«)</label><input type="text" id="booking-line" class="form-input" placeholder="æ–¹ä¾¿æˆ‘å€‘è¯ç¹«æ‚¨"></div>
            <div class="form-group">
                <label class="form-label">é¸æ“‡æœå‹™é …ç›® <span class="required">*</span></label>
                <select id="booking-service" class="form-select">
                    <option value="å°ˆæ¥­é‹å‹•æŒ‰æ‘© 60min ($1,200)">å°ˆæ¥­é‹å‹•æŒ‰æ‘© 60min ($1,200)</option>
                    <option value="å°ˆæ¥­é‹å‹•æŒ‰æ‘© 90min ($1,800)">å°ˆæ¥­é‹å‹•æŒ‰æ‘© 90min ($1,800)</option>
                    <option value="å¼µåŠ›èª¿æ•´ 60min ($1,400)">å¼µåŠ›èª¿æ•´ 60min ($1,400)</option>
                    <option value="å¼µåŠ›èª¿æ•´ 90min ($2,000)">å¼µåŠ›èª¿æ•´ 90min ($2,000)</option>
                    <option value="ä½¿ç”¨åŒ…å ‚æ–¹æ¡ˆ (æ‰£1å ‚)">ä½¿ç”¨åŒ…å ‚æ–¹æ¡ˆ (æ‰£1å ‚)</option>
                </select>
            </div>
            <button id="confirm-btn" class="btn-main" style="width:100%; border:none; margin-top:10px;" onclick="confirmBooking()">ç¢ºèªé€å‡º</button>
        </div>
    </div>
    
    <div id="toast-msg">âœ… è¨­å®šå·²æ›´æ–°</div>
    <div id="admin-login-overlay"><div class="admin-login-box"><h2 style="color:var(--brand-color);">å¾Œå°ç®¡ç†ç³»çµ±</h2><input type="password" id="admin-password" class="login-input" placeholder="å¯†ç¢¼"><button class="login-btn" onclick="checkAdminLogin()">ç™»å…¥</button><button class="login-btn" onclick="closeAdmin()" style="background:#ccc; margin-top:10px; color:#555;">å–æ¶ˆ</button></div></div>

    <div id="admin-panel">
        <div class="admin-header"><h1>ç®¡ç†å¾Œå°</h1><div><button onclick="logoutAdmin()" class="control-btn" style="margin-right:10px;">é›¢é–‹å¾Œå°</button></div></div>
        <div class="admin-container">
            <div class="dashboard-grid">
                <div class="dash-card"><div class="dash-num" id="today-count">0</div><div class="dash-label">ä»Šæ—¥é ç´„</div></div>
                <div class="dash-card"><div class="dash-num" id="month-revenue" style="color:#e67e22;">$0</div><div class="dash-label">æœ¬æœˆé ä¼°ç‡Ÿæ”¶</div></div>
            </div>
            <div class="admin-card">
                <div class="admin-month-header"><button class="month-btn" onclick="prevMonth()">â®</button><div class="month-title-group"><div class="admin-month-title" id="adminMonthYear"></div><button class="today-btn" onclick="resetToToday()">å›åˆ°ä»Šå¤©</button></div><button class="month-btn" onclick="nextMonth()">â¯</button></div>
                <div class="admin-toolbar"><button class="admin-tool-btn" onclick="toggleViewMode()" id="viewToggleBtn">ğŸ‘ï¸ åˆ‡æ›è©³ç´°æ¨¡å¼</button></div>
                <div class="admin-cal-grid" id="admin-cal-grid"></div>
            </div>
            <div id="day-detail">
                <div class="detail-header">
                    <div class="date-title" id="admin-date-title"></div>
                    <span id="daily-revenue-text" style="font-size:0.9rem; color:#e67e22; font-weight:bold;"></span>
                </div>
                <div id="order-list-container">è¼‰å…¥ä¸­...</div>
                <div class="admin-time-management"><div class="admin-time-title" id="admin-time-mgmt-title">âš™ï¸ æ™‚æ®µé–‹æ”¾ç®¡ç†</div><div class="admin-time-grid" id="admin-time-switches"></div></div>
                <div class="admin-big-btn-group"><button class="admin-big-btn btn-holiday-big" id="btn-set-holiday" onclick="toggleHoliday()">âŒ è¨­ç‚ºå…¨æ—¥åº—ä¼‘</button><button class="admin-big-btn btn-open-big" id="btn-open-holiday" style="display:none;" onclick="toggleHoliday()">âœ… æ¢å¾©å…¨æ—¥é–‹æ”¾</button></div>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwHge3GVg0WSZGecXiQSWHdT_pr8WRWWqsShPCKah6RfrzgFsy2n-7L82mzh6BQn90YdA/exec"; 

        let currentDate = new Date();
        let selectedDate = null;
        let selectedTime = null;
        let allOrders = []; 
        let holidays = [];
        let lockedSlots = [];
        const timeSlots = ['10:00', '12:00', '14:00', '15:40', '17:10', '19:30', '21:10'];
        const dayNames = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];

        window.onload = function() {
            const frontGrid = document.querySelector('.calendar-grid');
            if(frontGrid) frontGrid.id = 'calendar-grid-front';
            updateCalendars(); 
            fetchOrders();
        };

        function formatPhone(val) {
            val = val.replace(/\D/g, ''); 
            if(val.length > 10) val = val.slice(0, 10);
            if(val.length > 7) { return val.slice(0,4) + '-' + val.slice(4,7) + '-' + val.slice(7); } 
            else if(val.length > 4) { return val.slice(0,4) + '-' + val.slice(4); }
            return val;
        }

        function fetchOrders() {
            fetch(SCRIPT_URL)
            .then(res => res.json())
            .then(data => {
                const normalizeDate = (d) => {
                    if(!d) return "";
                    let str = String(d);
                    if(str.includes('T')) { let dateObj = new Date(str); if(!isNaN(dateObj.getTime())) return (dateObj.getMonth()+1) + "/" + dateObj.getDate(); }
                    str = str.replace(/-/g, '/');
                    let parts = str.split('/');
                    if(parts.length >= 2) return parseInt(parts[parts.length-2]) + "/" + parseInt(parts[parts.length-1]);
                    return str;
                };

                allOrders = data.filter(o => o.status !== 'holiday' && o.status !== 'locked' && o.status !== 'delete').map(o => ({...o, date: normalizeDate(o.date)}));
                holidays = data.filter(o => o.status === 'holiday').map(o => normalizeDate(o.date));
                const manualLocks = data.filter(o => o.status === 'locked').map(o => ({...o, date: normalizeDate(o.date)}));
                lockedSlots = [...allOrders, ...manualLocks];

                updateDashboard(); 
                updateCalendars(); 
                
                if(selectedDate) {
                    if(holidays.includes(selectedDate)) {
                         const container = document.getElementById('time-grid');
                         if(container) container.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:20px; color:#d63031; font-weight:bold; background:#fff0f0; border-radius:10px;">â›” æœ¬æ—¥åº—ä¼‘ï¼Œæš«åœæœå‹™</div>`;
                    } else {
                        renderTimeSlots(selectedDate);
                    }
                    const adminTimeContainer = document.getElementById('admin-time-switches');
                    if(adminTimeContainer && adminTimeContainer.innerHTML !== "") renderAdminTimeSwitches(selectedDate);
                    
                    if(document.getElementById('day-detail').style.display === 'block') {
                        // é‡æ–°å‘¼å«é¡¯ç¤ºè©³æƒ…ä»¥æ›´æ–°åˆ—è¡¨ (V63)
                        const cell = document.querySelector('.admin-cal-cell.selected');
                        showAdminDetail(parseInt(selectedDate.split('/')[1]), cell);
                    }
                }
            })
            .catch(err => console.error("è³‡æ–™è®€å–å¤±æ•—", err));
        }

        // ... (updateCalendars, renderCalendar, prevMonth, nextMonth, selectDate... ä¿æŒ V59) ...
        // ç‚ºäº†ç¯‡å¹…ï¼Œé€™è£¡çœç•¥æœˆæ›†æ¸²æŸ“å‡½å¼ï¼Œè«‹ä¿ç•™åŸ V59 çš„æœˆæ›†é‚è¼¯ï¼Œåªæ›´æ–° showAdminDetail

        function updateCalendars() {
            const y = currentDate.getFullYear();
            const m = currentDate.getMonth();
            const titleText = `${m + 1}æœˆ (${y})`;
            const frontTitle = document.getElementById('currentMonthYear');
            if(frontTitle) frontTitle.childNodes[0].nodeValue = titleText + " "; 
            const adminTitle = document.getElementById('adminMonthYear');
            if(adminTitle) adminTitle.innerText = titleText;
            renderCalendar(y, m, 'calendar-grid-front', false);
            renderCalendar(y, m, 'admin-cal-grid', true);
        }

        function renderCalendar(year, month, elementId, isAdmin) {
            const container = document.getElementById(elementId);
            if(!container) return;
            container.innerHTML = "";
            const headers = ['MON','TUE','WED','THU','FRI','SAT','SUN'];
            headers.forEach(day => {
                const div = document.createElement('div');
                div.className = isAdmin ? 'admin-cal-head' : 'cal-header';
                if(day === 'SAT' || day === 'SUN') div.style.color = '#ff4757';
                div.innerText = day;
                container.appendChild(div);
            });
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            let startSlot = (firstDay === 0) ? 6 : firstDay - 1;
            for(let i=0; i<startSlot; i++) { const empty = document.createElement('div'); container.appendChild(empty); }
            const today = new Date();
            for(let i=1; i<=daysInMonth; i++) {
                const cell = document.createElement('div');
                cell.className = isAdmin ? 'admin-cal-cell' : 'calendar-day';
                const dateStr = `${month+1}/${i}`;
                const hasOrder = allOrders.some(o => o.date === dateStr);
                const isHoliday = holidays.includes(dateStr); 
                const checkDate = new Date(year, month, i);
                const isPast = checkDate < new Date(today.setHours(0,0,0,0));
                const dayLockedCount = lockedSlots.filter(o => o.date === dateStr).length;
                const isFull = dayLockedCount >= timeSlots.length;

                if(year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) { cell.classList.add('today'); }
                if (isPast && !isAdmin) { cell.classList.add('disabled'); cell.innerHTML = `${i}`; } 
                else if(isHoliday) {
                    cell.classList.add('holiday');
                    if(isAdmin) { cell.innerHTML = `${i}<br><span style="font-size:0.6rem;">åº—ä¼‘</span>`; } 
                    else { cell.classList.remove('disabled'); cell.style.pointerEvents = "auto"; cell.innerHTML = `${i}<br><span>åº—ä¼‘</span>`; }
                } else if (isFull && !isAdmin) { cell.classList.add('full'); cell.innerHTML = `${i}<br><span>é¡æ»¿</span>`; cell.style.pointerEvents = "none"; } 
                else { cell.innerHTML = `${i}`; if(!isAdmin) cell.innerHTML += `<br><span>å¯ç´„</span>`; }

                if(isAdmin && hasOrder) {
                    cell.innerHTML += `<div class="dot active"></div>`;
                    const dailyOrders = allOrders.filter(o => o.date === dateStr);
                    dailyOrders.forEach(o => { cell.innerHTML += `<div class="event-text">${o.time} ${o.name}</div>`; });
                }
                if(isAdmin) { cell.onclick = function() { showAdminDetail(i, this); }; } 
                else { if(!isPast) cell.onclick = function() { selectDate(i, this); }; }
                container.appendChild(cell);
            }
        }
        function prevMonth() { currentDate.setMonth(currentDate.getMonth() - 1); updateCalendars(); }
        function nextMonth() { currentDate.setMonth(currentDate.getMonth() + 1); updateCalendars(); }
        function resetToToday() { currentDate = new Date(); updateCalendars(); }
        function selectDate(day, element) {
            selectedDate = `${currentDate.getMonth()+1}/${day}`;
            let days = document.querySelectorAll('.calendar-day');
            days.forEach(d => d.classList.remove('active'));
            element.classList.add('active');
            const dateDisplay = document.getElementById('selected-date-display');
            if(dateDisplay) dateDisplay.innerText = `${currentDate.getMonth()+1}æœˆ${day}æ—¥`;
            if(holidays.includes(selectedDate)) {
                 const container = document.getElementById('time-grid');
                 container.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:20px; color:#d63031; font-weight:bold; background:#fff0f0; border-radius:10px;">â›” æœ¬æ—¥åº—ä¼‘ï¼Œæš«åœæœå‹™</div>`;
            } else { renderTimeSlots(selectedDate); }
        }
        function renderTimeSlots(date) {
            const container = document.getElementById('time-grid');
            if(!container) return;
            container.innerHTML = "";
            timeSlots.forEach(time => {
                const btn = document.createElement('button');
                btn.className = 'time-btn';
                btn.innerText = time;
                const isLocked = lockedSlots.some(o => o.date === date && o.time === time);
                if(isLocked) { btn.classList.add('disabled'); btn.innerText += " (å·²æ»¿)"; btn.disabled = true; } 
                else { btn.onclick = function() { openBookingForm(time, this); }; }
                container.appendChild(btn);
            });
        }
        function openBookingForm(time, btnElement) {
            if(!selectedDate) { alert("è«‹å…ˆé¸æ“‡æ—¥æœŸå–”ï¼"); return; }
            selectedTime = time;
            let btns = document.querySelectorAll('.time-btn');
            btns.forEach(b => b.classList.remove('selected'));
            if(btnElement) btnElement.classList.add('selected');
            document.getElementById('booking-modal-overlay').style.display = 'flex';
            document.getElementById('booking-info-text').innerText = `æ‚¨é¸æ“‡çš„æ™‚æ®µï¼š${selectedDate} ${time}`;
        }
        function closeBookingForm() { document.getElementById('booking-modal-overlay').style.display = 'none'; }
        function confirmBooking() {
            const name = document.getElementById('booking-name').value;
            const phone = document.getElementById('booking-phone').value.trim();
            const lineId = document.getElementById('booking-line').value;
            const service = document.getElementById('booking-service').value;
            if(!name || !phone) { alert("è«‹å¡«å¯«å§“åå’Œé›»è©±ï¼"); return; }
            const cleanPhone = phone.replace(/-/g, "");
            if (!/^09\d{8}$/.test(cleanPhone)) { alert("âŒ æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼éŒ¯èª¤ï¼\nè«‹è¼¸å…¥ 09 é–‹é ­çš„ 10 ç¢¼æ•¸å­—"); return; }
            const btn = document.getElementById('confirm-btn');
            btn.innerText = "è™•ç†ä¸­..."; btn.disabled = true;
            let amount = "0";
            const match = service.match(/\$(\d+,?\d*)/);
            if(match) amount = match[1].replace(',', '');
            if(service.includes("åŒ…å ‚")) amount = "åŒ…å ‚æ‰£1";
            const data = { action: "order", date: selectedDate, time: selectedTime, name, phone, lineId, service, amount };
            fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(data), mode: "no-cors", headers: { "Content-Type": "text/plain" } }).then(() => {
                alert("âœ… é ç´„æˆåŠŸï¼\næˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„é ç´„ï¼Œè«‹æº–æ™‚å‰å¾€å·¥ä½œå®¤å³å¯ï¼");
                closeBookingForm();
                // é åˆ¤UI
                lockedSlots.push({ date: selectedDate, time: selectedTime, status: 'booked' });
                renderTimeSlots(selectedDate);
                
                btn.innerText = "ç¢ºèªé€å‡º"; btn.disabled = false;
                document.getElementById('booking-name').value = "";
                document.getElementById('booking-phone').value = "";
                document.getElementById('booking-line').value = "";
                setTimeout(fetchOrders, 2000); 
            }).catch(e => { alert("éŒ¯èª¤ï¼š" + e); btn.disabled = false; });
        }
        function openAdmin() { document.getElementById('admin-login-overlay').style.display = 'flex'; }
        function closeAdmin() { document.getElementById('admin-login-overlay').style.display = 'none'; }
        function checkAdminLogin() {
            const pwd = document.getElementById('admin-password').value;
            if(pwd === '8888') { 
                document.getElementById('admin-login-overlay').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.body.style.overflow = 'hidden'; 
                fetchOrders(); 
            } else { alert('å¯†ç¢¼éŒ¯èª¤ï¼'); }
        }
        function logoutAdmin() {
            document.getElementById('admin-panel').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.getElementById('admin-password').value = '';
        }
        function updateDashboard() {
            const todayStr = `${new Date().getMonth()+1}/${new Date().getDate()}`;
            const todayCount = allOrders.filter(o => o.date === todayStr).length;
            document.getElementById('today-count').innerText = todayCount;
            let total = 0;
            allOrders.forEach(o => { if(o.status !== 'delete' && o.status !== 'locked') { const price = parseInt(o.amount); if(!isNaN(price)) total += price; } });
            document.getElementById('month-revenue').innerText = `$${total.toLocaleString()}`;
        }

        // ğŸ”¥ V63.0: è¨‚å–®æ›´æ–°èˆ‡åˆ‡æ›é‚è¼¯
        function updateOrderStatus(date, time, name, currentStatus, elementId) {
            let newStatus, actionText;
            
            // åˆ¤æ–·åˆ‡æ›é‚è¼¯
            if (currentStatus === 'delete') {
                actionText = "å–æ¶ˆè¨‚å–®";
                newStatus = 'delete';
            } else if (currentStatus === 'å·²çµæ¡ˆ') {
                actionText = "å›å¾©ç‚ºæœªä»˜æ¬¾";
                newStatus = 'æœªè™•ç†';
            } else {
                actionText = "è¨­ç‚ºå·²çµæ¡ˆ";
                newStatus = 'å·²çµæ¡ˆ';
            }
            
            if(!confirm(`ç¢ºå®šè¦${actionText}å—ï¼Ÿ`)) return;
            
            showToast("â³ è™•ç†ä¸­...");
            
            // ğŸ”¥ é›¶å»¶é² UI æ›´æ–°
            const orderCard = document.getElementById(elementId);
            if (orderCard) {
                if (newStatus === 'delete') {
                    orderCard.style.opacity = '0.5'; // è®ŠåŠé€æ˜ç¤ºæ„åˆªé™¤
                    setTimeout(() => orderCard.remove(), 500); // ç§»é™¤å…ƒç´ 
                } else {
                    // æ›´æ–°æŒ‰éˆ•æ¨£å¼èˆ‡ç‹€æ…‹æ¨™ç±¤ (éœ€é‡æ–°æ¸²æŸ“å¡ç‰‡å…§å®¹æ¯”è¼ƒç°¡å–®ï¼Œé€™è£¡å…ˆåšè¦–è¦ºå›é¥‹)
                    // æ›´ç°¡å–®çš„æ–¹æ³•ï¼šç›´æ¥ä¿®æ”¹æœ¬åœ° allOrders é™£åˆ—ï¼Œç„¶å¾Œé‡æ–°å‘¼å« showAdminDetail
                    const orderIndex = allOrders.findIndex(o => o.date === date && o.time === time && o.name === name);
                    if(orderIndex > -1) {
                        allOrders[orderIndex].status = newStatus;
                        showAdminDetail(parseInt(date.split('/')[1]), null); // é‡ç•«åˆ—è¡¨
                    }
                }
            }

            const data = { action: "update_status", date, time, name, newStatus };
            fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(data), mode: "no-cors", headers: { "Content-Type": "text/plain" } })
            .then(() => {
                showToast(`âœ… å·²${actionText}`);
                setTimeout(fetchOrders, 1000); // èƒŒæ™¯åŒæ­¥
            }).catch(e => alert("éŒ¯èª¤ï¼š" + e));
        }

        function showAdminDetail(day, element) {
            if(element) {
                document.querySelectorAll('.admin-cal-cell').forEach(c => c.classList.remove('selected'));
                element.classList.add('selected');
            }
            selectedDate = `${currentDate.getMonth()+1}/${day}`; 
            document.getElementById('admin-date-title').innerText = selectedDate;
            document.getElementById('day-detail').style.display = 'block';

            const dailyOrders = allOrders.filter(o => o.date === selectedDate);
            const listContainer = document.getElementById('order-list-container');
            
            // ğŸ”¥ V63.0: è¨ˆç®—æœ¬æ—¥ç‡Ÿæ”¶
            let dailyRevenue = 0;
            dailyOrders.forEach(o => { if(o.status === 'å·²çµæ¡ˆ') { const p = parseInt(o.amount); if(!isNaN(p)) dailyRevenue += p; }});
            document.getElementById('daily-revenue-text').innerText = `ğŸ’° æœ¬æ—¥ç‡Ÿæ”¶: $${dailyRevenue.toLocaleString()}`;

            if(dailyOrders.length === 0) {
                listContainer.innerHTML = `<p style="text-align:center; color:#999; padding:20px;">ä»Šæ—¥ç„¡é ç´„</p>`;
            } else {
                let html = "";
                dailyOrders.forEach((o, index) => {
                    const lineInfo = o.lineId ? o.lineId : "ç„¡";
                    // è¨ˆç®—çµæŸæ™‚é–“
                    const [h, m] = o.time.split(':').map(Number);
                    const duration = o.service.includes('90') ? 90 : 60;
                    const endObj = new Date(0,0,0, h, m + duration);
                    const endTime = `${String(endObj.getHours()).padStart(2,'0')}:${String(endObj.getMinutes()).padStart(2,'0')}`;
                    
                    const isPaid = o.status === 'å·²çµæ¡ˆ';
                    const uniqueId = `order-${index}`; // è‡¨æ™‚ ID

                    // ğŸ”¥ V63.0: è¶…ç´šè©³æƒ…å¡ç‰‡ HTML
                    html += `
                    <div class="order-item" id="${uniqueId}">
                        <div class="order-header">
                            <span class="order-time-badge">${o.time} - ${endTime}</span>
                            <span class="status-badge ${isPaid ? 'paid' : ''}">${o.status}</span>
                        </div>
                        <div class="info-row"><span class="info-label">å§“å</span><span class="info-value">${o.name}</span></div>
                        <div class="info-row"><span class="info-label">é›»è©±</span><span class="info-value"><a href="tel:${o.phone}">${o.phone}</a></span></div>
                        <div class="info-row"><span class="info-label">LINE</span><span class="info-value">${lineInfo}</span></div>
                        <div class="info-row"><span class="info-label">é …ç›®</span><span class="info-value" style="font-size:0.85rem;">${o.service}</span></div>
                        <div class="info-row"><span class="info-label">é‡‘é¡</span><span class="info-value" style="color:#e67e22; font-weight:bold;">$${o.amount}</span></div>
                        
                        <div class="action-btns">
                            <button class="status-btn btn-done ${isPaid ? 'undo' : ''}" 
                                onclick="updateOrderStatus('${o.date}', '${o.time}', '${o.name}', '${isPaid ? 'å·²çµæ¡ˆ' : 'æœªè™•ç†'}', '${uniqueId}')">
                                ${isPaid ? 'â†©ï¸ å›å¾©æœªä»˜æ¬¾' : 'âœ… è¨­ç‚ºå·²çµæ¡ˆ'}
                            </button>
                            <button class="status-btn btn-cancel" 
                                onclick="updateOrderStatus('${o.date}', '${o.time}', '${o.name}', 'delete', '${uniqueId}')">
                                ğŸ—‘ï¸ å–æ¶ˆè¨‚å–®
                            </button>
                        </div>
                    </div>`;
                });
                listContainer.innerHTML = html;
            }
            
            // æŒ‰éˆ•é¡¯ç¤ºé‚è¼¯
            const isHoliday = holidays.includes(selectedDate);
            const btnHoliday = document.getElementById('btn-set-holiday');
            const btnOpen = document.getElementById('btn-open-holiday');
            if(isHoliday) { btnHoliday.style.display = 'none'; btnOpen.style.display = 'flex'; } 
            else { btnHoliday.style.display = 'flex'; btnOpen.style.display = 'none'; }
            
            renderAdminTimeSwitches(selectedDate);
            if(element) document.getElementById('day-detail').scrollIntoView({behavior: "smooth"});
        }
        
        function renderAdminTimeSwitches(date) {
            const container = document.getElementById('admin-time-switches');
            container.innerHTML = "";
            const dateObj = new Date(new Date().getFullYear(), date.split('/')[0]-1, date.split('/')[1]);
            const dayOfWeek = dayNames[dateObj.getDay()];
            document.getElementById('admin-time-mgmt-title').innerText = `âš™ï¸ æ™‚æ®µé–‹æ”¾ç®¡ç†ï¼š${date} (${dayOfWeek})`;
            timeSlots.forEach(time => {
                const order = allOrders.find(o => o.date === date && o.time === time);
                const isManualLocked = lockedSlots.some(o => o.date === date && o.time === time && o.status === 'locked');
                const isBooked = !!order; 
                let html = `<div class="time-switch" style="${isBooked ? 'background:#fff3cd' : ''}">${time} ${isBooked ? '(å®¢)' : ''}<input type="checkbox" class="switch-input" ${(isBooked || isManualLocked) ? '' : 'checked'} ${isBooked ? 'disabled' : ''} onchange="toggleTimeLock('${time}', this.checked)"></div>`;
                container.innerHTML += html;
            });
        }
        
        function toggleTimeLock(time, isChecked) {
            const actionText = isChecked ? "é–‹æ”¾" : "é–å®š";
            showToast(`â³ æ­£åœ¨${actionText}æ™‚æ®µ...`);
            const data = { action: "toggle_time_lock", date: selectedDate, time: time };
            fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(data), mode: "no-cors", headers: { "Content-Type": "text/plain" } }).then(() => { showToast(`âœ… æ™‚æ®µå·²${actionText}`); setTimeout(fetchOrders, 1000); }).catch(e => alert("éŒ¯èª¤ï¼š" + e));
        }
        function toggleHoliday() {
            if(!selectedDate) return;
            const dateStr = selectedDate; 
            const isCurrentlyHoliday = holidays.includes(dateStr);
            const actionText = isCurrentlyHoliday ? "æ¢å¾©é–‹æ”¾" : "è¨­ç‚ºåº—ä¼‘";
            if(!confirm(`ç¢ºå®šè¦å°‡ ${dateStr} ${actionText} å—ï¼Ÿ`)) return;
            showToast("â³ è™•ç†ä¸­...");
            const data = { action: "toggle_holiday", date: dateStr };
            fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(data), mode: "no-cors", headers: { "Content-Type": "text/plain" } }).then(() => {
                showToast(`âœ… ${dateStr} å·²${actionText}ï¼`);
                if(isCurrentlyHoliday) { holidays = holidays.filter(d => d !== dateStr); } else { holidays.push(dateStr); }
                updateCalendars(); 
                setTimeout(fetchOrders, 1000);
                const cell = document.querySelector('.admin-cal-cell.selected');
                if(cell) showAdminDetail(parseInt(dateStr.split('/')[1]), cell);
            }).catch(e => alert("éŒ¯èª¤ï¼š" + e));
        }
        function toggleViewMode() {
            const grid = document.getElementById('admin-cal-grid');
            const btn = document.getElementById('viewToggleBtn');
            grid.classList.toggle('detail-mode');
            if (grid.classList.contains('detail-mode')) { btn.innerText = "ğŸ‘ï¸ åˆ‡æ›ç°¡æ˜“æ¨¡å¼"; } else { btn.innerText = "ğŸ‘ï¸ åˆ‡æ›è©³ç´°æ¨¡å¼"; }
        }
        function showToast(msg) {
            const toast = document.getElementById('toast-msg');
            toast.innerText = msg;
            toast.style.opacity = '1';
            setTimeout(() => { toast.style.opacity = '0'; }, 2000);
        }
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
        function scrollToBottom() { window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); }
        
        var swiper = new Swiper(".mySwiper", { slidesPerView: 1, slidesPerGroup: 1, spaceBetween: 20, loop: true, breakpoints: { 768: { slidesPerView: 3, slidesPerGroup: 3, spaceBetween: 30 } }, pagination: { el: ".swiper-pagination", clickable: true }, navigation: { nextEl: ".my-next-btn", prevEl: ".my-prev-btn" }, autoplay: { delay: 4000, disableOnInteraction: false } });
        var offerSwiper = new Swiper(".offerSwiper", { slidesPerView: 1, spaceBetween: 30, loop: true, autoplay: { delay: 5000, disableOnInteraction: false }, pagination: { el: ".offerSwiper .swiper-pagination", clickable: true }, navigation: { nextEl: ".offerSwiper .swiper-button-next", prevEl: ".offerSwiper .swiper-button-prev" } });
        
        let isScrolling;
        const floatBtns = document.querySelector('.floating-btn-container');
        window.addEventListener('scroll', function() {
            floatBtns.style.opacity = '1'; floatBtns.style.pointerEvents = 'auto'; 
            window.clearTimeout(isScrolling);
            isScrolling = setTimeout(function() { floatBtns.style.opacity = '0.3'; }, 2000); 
        }, false);
        
        let lastScrollTop = 0;
        const header = document.querySelector('header');
        window.addEventListener('scroll', function() {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (scrollTop > lastScrollTop && scrollTop > 50) { header.classList.add('nav-hidden'); } else { header.classList.remove('nav-hidden'); }
            lastScrollTop = scrollTop;
        });
    </script>
</body>
</html>
